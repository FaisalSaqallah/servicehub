<h2>Welcome, Admin!</h2>

<div class="dashboard-container">

  <nav>
    <button (click)="view = 'services'">Manage Services</button>
    <button (click)="view = 'customers'">Manage Customers</button>
    <button (click)="view = 'appointments'">Manage Appointments</button>
  </nav>

  <!-- SERVICES SECTION -->
  <div *ngIf="view === 'services'">
    <h3>{{ editingIndex !== null ? 'Edit Service' : 'Add a Service' }}</h3>
    <form [formGroup]="serviceForm" (ngSubmit)="editingIndex !== null ? updateService() : addService()">
      <input type="text" placeholder="Name" formControlName="name">
      <div *ngIf="serviceForm.get('name')?.invalid && serviceForm.get('name')?.touched" class="error">Name is required</div>

      <input type="text" placeholder="Description" formControlName="description">
      <div *ngIf="serviceForm.get('description')?.invalid && serviceForm.get('description')?.touched" class="error">Description is required</div>

      <input type="text" placeholder="Category" formControlName="category">
      <div *ngIf="serviceForm.get('category')?.invalid && serviceForm.get('category')?.touched" class="error">Category is required</div>

      <input type="number" placeholder="Price" formControlName="price">
      <div *ngIf="serviceForm.get('price')?.invalid && serviceForm.get('price')?.touched" class="error">Price is required and must be a number</div>

      <button type="submit" [disabled]="serviceForm.invalid">
        {{ editingIndex !== null ? 'Update Service' : 'Add Service' }}
      </button>
      <button *ngIf="editingIndex !== null" type="button" (click)="cancelEdit()">Cancel</button>
    </form>

    <input type="text" placeholder="Search services..." [(ngModel)]="serviceSearch" />

    <h3>Available Services</h3>
    <table class="info-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Category</th>
          <th>Price (SAR)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let service of services; let i = index">
          <td>{{ service.name }}</td>
          <td>{{ service.description }}</td>
          <td>{{ service.category }}</td>
          <td>{{ service.price }}</td>
          <td>
            <button (click)="editService(i)">Edit</button>
            <button (click)="deleteService(i)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- CUSTOMERS SECTION -->
  <div *ngIf="view === 'customers'">
    <h3>{{ editingCustomerIndex !== null ? 'Edit Customer' : 'Add a Customer' }}</h3>
    <form [formGroup]="customerForm" (ngSubmit)="addCustomer()">
      <input type="text" placeholder="Name" formControlName="name">
      <div *ngIf="customerForm.get('name')?.invalid && customerForm.get('name')?.touched" class="error">Name is required</div>

      <input type="email" placeholder="Email" formControlName="email">
      <div *ngIf="customerForm.get('email')?.invalid && customerForm.get('email')?.touched" class="error">Valid email is required</div>

      <input type="text" placeholder="Phone" formControlName="phone">
      <div *ngIf="customerForm.get('phone')?.invalid && customerForm.get('phone')?.touched" class="error">Phone is required</div>

      <select formControlName="status">
        <option value="Active">Active</option>
        <option value="Inactive">Inactive</option>
      </select>
      <div *ngIf="customerForm.get('status')?.invalid && customerForm.get('status')?.touched" class="error">Status is required</div>

      <button type="submit" [disabled]="customerForm.invalid">
        {{ editingCustomerIndex !== null ? 'Update Customer' : 'Add Customer' }}
      </button>
      <button type="button" *ngIf="editingCustomerIndex !== null" (click)="cancelCustomerEdit()">Cancel</button>
    </form>

    <h3>Customers</h3>
    <table class="info-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of customers; let i = index">
          <td>{{ c.name }}</td>
          <td>{{ c.email }}</td>
          <td>{{ c.phone }}</td>
          <td>{{ c.status }}</td>
          <td>
            <button (click)="editCustomer(i)">Edit</button>
            <button (click)="deleteCustomer(i)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- APPOINTMENTS SECTION -->
  <div *ngIf="view === 'appointments'">
    <h3>Appointments</h3>
    <table class="info-table">
      <thead>
        <tr>
          <th>Customer</th>
          <th>Service</th>
          <th>Date</th>
          <th>Time</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let a of appointments; let i = index">
          <td>{{ a.customer }}</td>
          <td>{{ a.service }}</td>
          <td>{{ a.date }}</td>
          <td>{{ a.time }}</td>
          <td>
            <select [(ngModel)]="a.status" (change)="updateAppointmentStatus(a)">
              <option value="Pending">Pending</option>
              <option value="Approved">Approved</option>
              <option value="Completed">Completed</option>
              <option value="Rejected">Rejected</option>
            </select>
          </td>
          <td><button (click)="deleteAppointment(i)">Delete</button></td>
        </tr>
      </tbody>
    </table>
  </div>

</div>